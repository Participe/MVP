{% extends 'organization_base.html' %}
{% load i18n %}

{% block title %}{% trans "Organizations list" %} - {{ block.super }}{% endblock %}
{% load thumbnail %}

{% block extra_content %}
    <style type="text/css">
        td {vertical-align:top;}
    </style>
    
    <div class="modal" style="width:60%; position:relative; top:auto; left:auto; margin:0 auto; z-index:1;">
        <div class="modal-header">
            <a class="btn" href="/organizations/create/">{% trans "Create new organization" %}</a>
        </div>
        <div class="modal-body">
            <table>
                <tr>
                    <th style="min-width:50px;"></th>
                    <th>Name</th>
                    <th>Description</th>
                    <th>Challenges</th>
                </tr>
            {% for organization in organizations %}
                <tr>
                    <td><a href="{{ organization.get_absolute_url }}"><img src="{% thumbnail organization.avatar|default:'img/default.jpg' 50x50 crop %}" alt=""></a></td>
                    <td><a href="{{ organization.get_absolute_url }}">{{ organization.name }}</a></td>
                    <td>{{ organization.description }}</td>
                    <td>
                    {% with challenges=organization.challenge_set.all %}
                        {% for challenge in challenges|slice:":4"|dictsort:"start_date" %}
                            <a href="{{ challenge.get_absolute_url }}">{{ challenge.name }} ({{ challenge.start_date }}){% if not forloop.last %}, {% endif %}</a>
                        {% endfor %}
                        {% if challenges.count > 4 %}
                            <a href="{{ organization.get_absolute_url }}">... show {{ challenges.count|add:"-4" }} more challenge(s)</a></td>
                        {% endif %}
                    {% endwith %}
                    </td>
                </tr>
            {% empty %}
                <p>{% trans "There are no organizations" %}</p>
            {% endfor %}
            </table>
        </div>
        <div class="modal-footer">
        </div>
    </div>
{% endblock %}
